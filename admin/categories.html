<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Quản lý loại sản phẩm</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>

  <!-- HEADER -->
  <div class="custom-header">
    <div class="dashboard-title">DASHBOARD</div>
    <nav class="admin-nav-inline">
      <ul>
        <li><a href="dashboard.html">TỔNG QUAN</a></li>
        <li><a href="users.html">NGƯỜI DÙNG</a></li>
        <li><a href="categories.html" class="active">LOẠI SP</a></li>
        <li><a href="products.html">SẢN PHẨM</a></li>
        <li><a href="import.html">NHẬP HÀNG</a></li>
        <li><a href="pricing.html">GIÁ BÁN</a></li>
        <li><a href="orders.html">ĐƠN HÀNG</a></li>
        <li><a href="inventory.html">TỒN KHO</a></li>
        <li><a href="../index.html">THOÁT</a></li>
      </ul>
    </nav>
  </div>

  <!-- NỘI DUNG -->
  <main class="admin-content">
    <div class="page-title">
      <a href="dashboard.html">Quay lại Dashboard</a>
      Quản lý loại sản phẩm
    </div>

    <!-- FORM THÊM -->
    <div class="action-bar">
      <form class="categories-form" onsubmit="event.preventDefault(); alert('Đã thêm loại mới!');">
        <input type="text" placeholder="Tên loại sản phẩm">
        <button type="submit" class="btn-add">Thêm</button>
      </form>
    </div>

    <!-- BẢNG DANH SÁCH -->
    <div class="content-box">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Tên loại</th>
            <th>Hành động</th>
          </tr>
        </thead>
        <tbody id="categoriesBody">
          <!-- JS sinh bảng -->
        </tbody>
      </table>
      <!-- PHÂN TRANG -->
      <div class="content-pagination">
        <div class="pagination">
          <button class="prev">&lt;</button>
          <button class="page active">1</button>
          <button class="page">2</button>
          <button class="page">3</button>
          <button class="page">4</button>
          <button class="next">&gt;</button>
        </div>
      </div>
    </div>
  </main>

  <!-- JS: TỰ ĐỘNG HIỂN THỊ LOẠI -->
  <script src="../data-book.js"></script>
  <script>
    const tbody = document.getElementById("categoriesBody");

    const typeMap = {
      "history-img": "Lịch sử",
      "sceince-img": "Khoa học",
      "poem-img": "Thơ",
      "everypic-img": "Văn học nước ngoài"
    };

    const categories = [...new Set(
      books.map(b => {
        for (const [folder, name] of Object.entries(typeMap)) {
          if (b.image.includes(folder)) return name;
        }
        return "Văn học Việt Nam";
      })
    )];

    tbody.innerHTML = categories.map((name, index) => {
      const id = String(index + 1).padStart(3, '0');
      return `
        <tr>
          <td>${id}</td>
          <td>${name}</td>
          <td>
            <a href="#editModal-${id}" class="btn-small btn-reset">Sửa</a>
            <a href="#deleteModal-${id}" class="btn-small btn-lock">Xóa</a>
          </td>
        </tr>
      `;
    }).join('');
  </script>

  <!-- MODAL SỬA & XÓA CHO TỪNG LOẠI (TỰ ĐỘNG TỪ JS) -->
  <script>
    // Tạo modal cho từng loại
    const modalsContainer = document.createElement('div');
    document.body.appendChild(modalsContainer);

    const categoriesList = [...new Set(
      books.map(b => {
        for (const [folder, name] of Object.entries(typeMap)) {
          if (b.image.includes(folder)) return name;
        }
        return "Văn học Việt Nam";
      })
    )];

    categoriesList.forEach((name, index) => {
      const id = String(index + 1).padStart(3, '0');
      modalsContainer.innerHTML += `
        <!-- SỬA ${id} -->
        <div id="editModal-${id}" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <div class="modal-title">Sửa loại sản phẩm</div>
              <a href="#" class="modal-close">×</a>
            </div>
            <form class="modal-form">
              <div><label>ID</label><input type="text" value="${id}" disabled></div>
              <div><label>Tên loại</label><input type="text" value="${name}"></div>
              <div class="modal-actions">
                <a href="#" class="btn-save" onclick="alert('Đã lưu!')">Lưu</a>
                <a href="#" class="btn-cancel">Hủy</a>
              </div>
            </form>
          </div>
        </div>

        <!-- XÓA ${id} -->
        <div id="deleteModal-${id}" class="modal">
          <div class="modal-content">
            <div class="modal-header">
              <div class="modal-title">Xác nhận xóa</div>
              <a href="#" class="modal-close">×</a>
            </div>
            <div class="confirm-delete">
              <p>Bạn có chắc muốn xóa <strong>${name}</strong> không?</p>
              <div class="modal-actions">
                <a href="#" class="btn-save" style="background:#d32f2f;" onclick="alert('Đã xóa!')">Xóa</a>
                <a href="#" class="btn-cancel">Hủy</a>
              </div>
            </div>
          </div>
        </div>
      `;
    });
  </script>

  <script>
    // PHÂN TRANG NHƯNG CHỈ NHẢY MÀU
    document.addEventListener("DOMContentLoaded", () => {
      const pages = document.querySelectorAll('.pagination .page');
      const prevBtn = document.querySelector('.pagination .prev');
      const nextBtn = document.querySelector('.pagination .next');

      function setActive(index) {
        pages.forEach(p => p.classList.remove('active'));
        pages[index].classList.add('active');
        prevBtn.disabled = index === 0;
        nextBtn.disabled = index === pages.length - 1;
      }

      pages.forEach((btn, idx) => {
        btn.addEventListener('click', () => setActive(idx));
      });

      prevBtn.addEventListener('click', () => {
        let current = [...pages].findIndex(p => p.classList.contains('active'));
        if (current > 0) setActive(current - 1);
      });

      nextBtn.addEventListener('click', () => {
        let current = [...pages].findIndex(p => p.classList.contains('active'));
        if (current < pages.length - 1) setActive(current + 1);
      });

      setActive(0); // Trang 1 được chọn ban đầu
    });
  </script>

</body>
</html>
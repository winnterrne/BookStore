<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Quản lý sản phẩm</title>
  <link rel="stylesheet" href="admin.css">
</head>
<body>

  <!-- THÔNG BÁO -->
  <div id="alertBox" class="alert">Đã thêm sản phẩm mới!</div>

  <!-- HEADER -->
  <div class="custom-header">
    <div class="dashboard-title">DASHBOARD</div>
    <nav class="admin-nav-inline">
      <ul>
        <li><a href="dashboard.html">TỔNG QUAN</a></li>
        <li><a href="users.html">NGƯỜI DÙNG</a></li>
        <li><a href="categories.html">LOẠI SP</a></li>
        <li><a href="products.html" class="active">SẢN PHẨM</a></li>
        <li><a href="import.html">NHẬP HÀNG</a></li>
        <li><a href="pricing.html">GIÁ BÁN</a></li>
        <li><a href="orders.html">ĐƠN HÀNG</a></li>
        <li><a href="inventory.html">TỒN KHO</a></li>
        <li><a href="../index.html">THOÁT</a></li>
      </ul>
    </nav>
  </div>

  <main class="admin-content">
    <div class="page-title">
      <a href="dashboard.html">Quay lại Dashboard</a>
      Quản lý sản phẩm
    </div>

        <!-- FORM THÊM -->
        <div class="action-bar">
          <form class="products-form-grid two-columns" onsubmit="addProduct(); return false;">
            <!-- CỘT 1 -->
            <div class="form-column">
              <input type="text" id="addCode" placeholder="Mã sản phẩm" required>
              <input type="text" id="addName" placeholder="Tên sản phẩm" required>
              <input type="text" id="addAuthor" placeholder="Tác giả">
              <input type="text" id="addType" placeholder="Loại sản phẩm">
              <input type="text" id="addSize" placeholder="Kích thước (ví dụ: 13x20cm)">
            </div>

            <!-- CỘT 2 -->
            <div class="form-column">
              <input type="number" id="addYear" placeholder="Năm xuất bản">
              <input type="number" id="addPages" placeholder="Số trang">
              <input type="text" id="addPublisher" placeholder="Nhà xuất bản">
              <input type="text" id="addTranslator" placeholder="Dịch giả">
              <textarea id="addDesc" placeholder="Mô tả sản phẩm" rows="5"></textarea>
            </div>

            <!-- DÒNG FILE + NÚT (căn giữa) -->
            <div class="form-fullrow">
              <input type="file" id="addImage" accept="image/*">
              <button type="submit" class="btn-add">Thêm sản phẩm</button>
            </div>
          </form>
        </div>

    <!-- BẢNG -->
    <div class="content-box">
      <h2 class="section-title">Danh sách sản phẩm</h2>
      <table class="table">
        <thead>
          <tr>
            <th>Mã</th>
            <th>Tên</th>
            <th>Tác giả</th>
            <th>Loại</th>
            <th>Hình/Mô tả</th>
            <th>Hành động</th>
          </tr>
        </thead>
        <tbody id="productBody"></tbody>
      </table>
      <!-- PHÂN TRANG -->
      <div class="content-pagination">
        <div class="pagination">
          <button class="prev">&lt;</button>
          <button class="page active">1</button>
          <button class="page">2</button>
          <button class="page">3</button>
          <button class="page">4</button>
          <button class="page">5</button>
          <button class="page">6</button>
          <button class="next">&gt;</button>
        </div>
      </div>
    </div>
  </main>

  <!-- JS -->
  <script src="../data-book.js"></script>
  <script>
  const tbody = document.getElementById("productBody");

  /* ---------- GÁN LOẠI ---------- */
  books.forEach(b => {
    if (b.image.includes("history-img")) b.type = "Lịch sử";
    else if (b.image.includes("sceince-img")) b.type = "Khoa học";
    else if (b.image.includes("poem-img")) b.type = "Thơ";
    else if (b.image.includes("everypic-img")) b.type = "Văn học nước ngoài";
    else b.type = "Văn học Việt Nam";
  });

  /* ---------- RENDER + MODAL ---------- */
  function render() {
    tbody.innerHTML = books.map((b, i) => `
      <tr>
        <td>${b.id}</td>
        <td>${b.title}</td>
        <td>${b.author}</td>
        <td>${b.type}</td>
        <td><img src="../${b.image}" width="50" class="thumb-img"></td>
        <td class="actions">
          <a href="#viewModal-${i}" class="btn-small btn-view">Xem</a>
          <a href="#editModal-${i}" class="btn-small btn-reset">Sửa</a>
          <a href="#deleteModal-${i}" class="btn-small btn-lock">Xóa</a>
        </td>
      </tr>
    `).join('');

    const modals = document.createElement('div');
    books.forEach((b, i) => {
      /* ---- VIEW MODAL ---- */
      modals.innerHTML += `
        <div id="viewModal-${i}" class="modal">
          <div class="modal-content product-detail-modal">
            <div class="modal-header">
              <div class="modal-title">Chi tiết sản phẩm</div>
              <a href="#" class="modal-close">×</a>
            </div>

            <div class="detail-layout">
              <!-- CỘT TRÁI: ẢNH + BOX THÔNG TIN CHI TIẾT SIÊU TO -->
              <div class="left-column">
                <img src="../${b.image}" class="detail-img" alt="${b.title}">

                <div class="info-box">
                  <div><span class="label">Dịch giả:</span> <span class="value">${b.translator || 'Không có'}</span></div>
                  <div><span class="label">Nhà xuất bản:</span> <span class="value">${b.publisher || 'Chưa cập nhật'}</span></div>
                  <div><span class="label">Kích thước:</span> <span class="value">${b.size || 'Chưa cập nhật'}</span></div>
                  <div><span class="label">Số trang:</span> <span class="value">${b.pages ? b.pages + ' trang' : 'Chưa cập nhật'}</span></div>
                  <div><span class="label">Năm phát hành:</span> <span class="value">${b.year || 'Chưa cập nhật'}</span></div>
                </div>
              </div>

              <!-- CỘT PHẢI: TIÊU ĐỀ + LOẠI/TÁC GIẢ + MÔ TẢ -->
              <div class="right-column">
                <h1 class="detail-title">${b.title}</h1>
                
                <div class="detail-basic">
                  <p><strong>Loại:</strong> ${b.type}</p>
                  <p><strong>Tác giả:</strong> ${b.author}</p>
                </div>

                <div class="detail-desc">
                  <strong>Mô tả:</strong><br><br>
                  ${b.description ? b.description.replace(/<br>/g, '<br>') : 'Chưa có mô tả chi tiết.'}
                </div>
              </div>
            </div>

            <div class="modal-actions modal-actions-right">
              <a href="#" class="btn-cancel">Đóng</a>
            </div>
          </div>
        </div>
      `;

        /* ---- EDIT MODAL ---- */
        modals.innerHTML += `
          <div id="editModal-${i}" class="modal">
            <div class="modal-content">
              <div class="modal-header">
                <div class="modal-title">Sửa sản phẩm</div>
                <a href="#" class="modal-close">×</a>
              </div>
              <form class="modal-form">
                <div><label>Mã</label><input type="text" value="${b.id}" disabled></div>
                <div><label>Tên</label><input type="text" value="${b.title}"></div>
                <div><label>Tác giả</label><input type="text" value="${b.author}"></div>
                <div><label>Loại</label><input type="text" value="${b.type}"></div>
                <div><label>Mô tả</label>
                  <textarea class="edit-desc-textarea"></textarea>
                </div>
                <div class="modal-actions">
                  <a href="#" class="btn-save" onclick="showAlert('Đã lưu thay đổi!')">Lưu</a>
                  <a href="#" class="btn-cancel">Hủy</a>
                </div>
              </form>
            </div>
          </div>
        `;

        /* ---- DELETE MODAL ---- */
        modals.innerHTML += `
          <div id="deleteModal-${i}" class="modal">
            <div class="modal-content">
              <div class="modal-header">
                <div class="modal-title">Xác nhận xóa</div>
                <a href="#" class="modal-close">×</a>
              </div>
              <div class="confirm-delete">
                <p>Bạn có chắc muốn xóa <strong>${b.title}</strong> không?</p>
                <div class="modal-actions">
                  <a href="#" class="btn-save" style="background:#d32f2f;" onclick="showAlert('Đã xóa sản phẩm!')">Xóa</a>
                  <a href="#" class="btn-cancel">Hủy</a>
                </div>
              </div>
            </div>
          </div>
        `;
      });
      document.body.appendChild(modals);
    }

    /* ---------- ALERT ---------- */
    function showAlert(msg) {
      const alert = document.getElementById('alertBox');
      alert.textContent = msg;
      alert.classList.add('show');
      setTimeout(() => alert.classList.remove('show'), 3000);
    }

    /* ---------- THÊM SẢN PHẨM ---------- */
    function addProduct() {
      const code = document.getElementById('addCode').value.trim();
      const name = document.getElementById('addName').value.trim();
      if (!code || !name) return showAlert('Vui lòng nhập Mã và Tên!');
      showAlert('Đã thêm sản phẩm mới!');
      document.querySelector('.products-form-grid').reset();
    }

    render();
  </script>

  <script>
  // PHÂN TRANG NHƯNG CHỈ NHẢY MÀU
  document.addEventListener("DOMContentLoaded", () => {
    const pages = document.querySelectorAll('.pagination .page');
    const prevBtn = document.querySelector('.pagination .prev');
    const nextBtn = document.querySelector('.pagination .next');

    function setActive(index) {
      pages.forEach(p => p.classList.remove('active'));
      pages[index].classList.add('active');
      prevBtn.disabled = index === 0;
      nextBtn.disabled = index === pages.length - 1;
    }

    pages.forEach((btn, idx) => {
      btn.addEventListener('click', () => setActive(idx));
    });

    prevBtn.addEventListener('click', () => {
      let current = [...pages].findIndex(p => p.classList.contains('active'));
      if (current > 0) setActive(current - 1);
    });

    nextBtn.addEventListener('click', () => {
      let current = [...pages].findIndex(p => p.classList.contains('active'));
      if (current < pages.length - 1) setActive(current + 1);
    });

    setActive(0); // Trang 1 được chọn ban đầu
  });
</script>

</body>
</html>